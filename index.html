<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Abrox ‚Äì Profit Hunters Chat</title>

<!-- External CSS -->
<link rel="stylesheet" href="widget.css" />

<style>
  /* Override minimal critical styles to use full 100dvh */
  html, body {
    height: 100dvh;
    margin: 0;
    font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    background: var(--tg-bg-gradient);
  }

  /* Header adjustments for Telegram scaling */
  .tg-header {
    height: 56px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 14px;
    border-bottom: 1px solid var(--tg-border);
    background: var(--tg-header-bg);
    position: sticky;
    top: 0;
    z-index: 20;
  }

  .tg-header-avatar { width: 36px; height: 36px; }
  .tg-title { font-size: 15px; font-weight: 500; }
  .tg-meta { font-size: 12px; }

  /* Floating pill input */
  .tg-input-wrapper {
    position: fixed;
    bottom: 12px;
    left: 50%;
    transform: translateX(-50%);
    width: calc(100% - 24px);
    max-width: 600px;
    background: var(--tg-input-bg);
    border-radius: 24px;
    padding: 6px 12px;
    display: flex;
    align-items: center;
    gap: 8px;
    z-index: 50;
  }

  .tg-comment-input {
    flex: 1;
    height: 36px;
    border-radius: 20px;
    padding: 6px 12px;
    border: 1px solid rgba(255,255,255,0.1);
    background: var(--tg-input-field);
    color: var(--tg-text);
    outline: none;
  }

  .tg-send-btn {
    display: none; /* hidden by default, shown when typing */
  }

  /* Responsive adjustments */
  @media (max-width: 520px) {
    .tg-header-avatar { width: 32px; height: 32px; }
    .tg-title { font-size: 14px; }
    .tg-meta { font-size: 11px; }
    .tg-input-wrapper { width: calc(100% - 16px); bottom: 8px; }
  }
</style>
</head>

<body>
<div id="tg-comments-app" class="tg-dark">

  <!-- Header -->
  <header class="tg-header" role="banner">
    <button class="tg-back-btn" aria-label="Back"><i data-lucide="arrow-left"></i></button>
    <div class="tg-header-center">
      <img src="assets/logo.jpg" alt="Profit Hunters Logo" class="tg-header-avatar" />
      <div class="tg-header-info">
        <div class="tg-title">üåê Profit Hunters Chat</div>
        <div class="tg-meta" id="tg-meta-line">1,284 members, 128 online</div>
      </div>
    </div>
    <button class="tg-options-btn" aria-label="Options"><i data-lucide="more-vertical"></i></button>
  </header>

  <!-- Pin banner (admin broadcast) -->
  <div id="tg-pin-banner" class="tg-pin-banner hidden"></div>

  <!-- Scrollable comments -->
  <main id="tg-comments-container" class="tg-comments-container" role="feed"></main>

  <!-- New message jump indicator -->
  <div id="tg-jump-indicator" class="hidden">
    <i data-lucide="chevron-down"></i> <span>New messages</span>
  </div>

  <!-- Floating pill-shaped input -->
  <div class="tg-input-wrapper">
    <button id="tg-emoji-btn" class="tg-icon-btn" aria-label="Emoji picker" type="button"><i data-lucide="smile"></i></button>
    <input type="text" id="tg-comment-input" class="tg-comment-input" placeholder="Message‚Ä¶" autocomplete="off"/>
    <button id="tg-camera-btn" class="tg-icon-btn" aria-label="Camera" type="button"><i data-lucide="camera"></i></button>
    <button id="tg-send-btn" class="tg-send-btn" aria-label="Send message"><i data-lucide="send"></i></button>
  </div>
</div>

<!-- Lucide icons -->
<script src="https://unpkg.com/lucide@latest"></script>
<script>lucide.createIcons();</script>

<!-- Modular JS -->
<script src="identity-personas.js"></script>
<script src="bubble-renderer.js"></script>
<script src="realism-engine-v11.js"></script>
<script src="interactions.js"></script>
<script src="app.js"></script>

<script>
  // Send button transform (modular, in app.js)
  const input = document.getElementById("tg-comment-input");
  const sendBtn = document.getElementById("tg-send-btn");
  const cameraBtn = document.getElementById("tg-camera-btn");

  input.addEventListener("input", () => {
    if(input.value.trim().length > 0){
      sendBtn.style.display = "flex";
      cameraBtn.style.display = "none";
    } else {
      sendBtn.style.display = "none";
      cameraBtn.style.display = "flex";
    }
  });
</script>
</body>
</html>
